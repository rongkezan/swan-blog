---
title: Redis常见缓存问题
date: {{ date }}
categories:
- 数据源
- Redis
---

# redis常见缓存问题

**缓存与数据库双写不一致**

现象1：先修改数据库，再删除缓存，如果缓存删除失败，缓存中是旧数据，就会出现数据不一致。

解决1：先删除缓存，再修改数据库，如果修改数据库失败了，数据库是旧数据，缓存为空，数据一致。

现象2：在更新一个库存的时候，同时在读取这个库存，此时数据库修改还未完成，旧的数据就会落到缓存中。

解决2：将数据库与缓存的更新和读取进行异步串行化。

**缓存雪崩**

现象：key集中过期导致短时间内大量请求落到数据库。

解决方案：过期时间使用固定时间+随机值模式，稀释集中到期的key的数量

**缓存穿透**

现象：查询一个一定不存在的数据，缓存不会命中

解决：空结果进行缓存，但它的过期时间会很短，最长不超过五分钟。

**缓存击穿**

现象：超高热点的key过期导致短时间内大量请求落到数据库。

解决：分布式锁

**缓存内存超出设置的最大值会发生什么**

OOM command not allowed when used memory